!function(factory){if("object"==typeof module&&"object"==typeof module.exports){var v=factory(require,exports);void 0!==v&&(module.exports=v)}else"function"==typeof define&&define.amd&&define(["require","exports","angular","./angular-stats.service"],factory)}(function(require,exports){"use strict";var angular=require("angular"),angular_stats_service_1=require("./angular-stats.service");exports.angularStats=angular.module("angularStats",[]).service("AngularStats",angular_stats_service_1.AngularStats).name}),function(factory){if("object"==typeof module&&"object"==typeof module.exports){var v=factory(require,exports);void 0!==v&&(module.exports=v)}else"function"==typeof define&&define.amd&&define(["require","exports","angular"],factory)}(function(require,exports){"use strict";var angular=require("angular"),AngularStats=function(){function AngularStats($rootScope,$document,$window,$timeout){this.digestInfo={duration:"0"},this.rootScope=$rootScope,this.document=$document,this.window=$window,this.timeout=$timeout,this.startingElement="app"}return AngularStats.prototype.setStartingElement=function(element){this.startingElement=element},AngularStats.prototype.analyzeWebApp=function(){var _this=this,scopesList=[],watchersList=[],componentsInfo={},domElementsCount=0,nodeNameList={},analizeScope=function(currentScope){if(scopesList.indexOf(currentScope)==-1){scopesList.push(currentScope);var name_1=currentScope.$ctrl?currentScope.$ctrl.name:"Unknown";void 0==componentsInfo[name_1]?componentsInfo[name_1]={name:name_1,scopesCount:1,watchers:[]}:componentsInfo[name_1].scopesCount++,angular.forEach(currentScope.$$watchers,function(watcher){watchersList.indexOf(watcher)==-1&&watchersList.push(watcher),componentsInfo[name_1].watchers.indexOf(watcher)==-1&&componentsInfo[name_1].watchers.push(watcher)}),currentScope.$$childHead&&analizeScope(currentScope.$$childHead),currentScope.$$childTail&&analizeScope(currentScope.$$childTail),currentScope.$$prevSibling&&analizeScope(currentScope.$$prevSibling),currentScope.$$nextSibling&&analizeScope(currentScope.$$nextSibling)}},detectFromElement=function(element){domElementsCount++,element.data().hasOwnProperty("$scope")&&analizeScope(element.data().$scope),angular.forEach(element.children(),function(childElement){void 0==nodeNameList[childElement.nodeName]?nodeNameList[childElement.nodeName]=1:nodeNameList[childElement.nodeName]++,detectFromElement(_this.document.find(childElement))})},calculateDigestDuration=function(){var duration=0,scopePrototype=Object.getPrototypeOf(_this.rootScope),angularDigest=scopePrototype.$digest;scopePrototype.$digest=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var start=performance?performance.now():_this.getTimeFrom1970();angularDigest.apply(_this.rootScope,args),duration=performance?performance.now()-start:_this.getTimeFrom1970()-start,_this.digestInfo.duration=duration.toFixed(2)}};analizeScope(this.rootScope),detectFromElement(this.document.find(this.startingElement)),calculateDigestDuration();var mex="GENERAL\n";mex+="----------------------\n",mex+="Tot scopes: "+scopesList.length+"\n",mex+="Tot watchers: "+watchersList.length+"\n",mex+="Tot DOM Elements: "+domElementsCount+"\n",mex+="Digest duration: "+this.digestInfo.duration+" ms \n\n",mex+="\nCOMPONENTS\n",mex+="----------------------\n";for(var name_2 in componentsInfo)mex+="- "+name_2.toUpperCase()+"\ns: "+componentsInfo[name_2].scopesCount+", w: "+componentsInfo[name_2].watchers.length+"\n";mex+="\n\nHTMLElement\n",mex+="----------------------\n";for(var nodeName in nodeNameList)mex+=nodeName+": "+nodeNameList[nodeName]+"\n";return mex},AngularStats.prototype.getTimeFrom1970=function(){return this.getNow().getTime()},AngularStats.prototype.getNow=function(){return new Date},AngularStats}();AngularStats.$inject=["$rootScope","$document","$window","$timeout"],exports.AngularStats=AngularStats});